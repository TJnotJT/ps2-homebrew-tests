Most of this code is taken/modified from https://github.com/F0bes/gs4ps2qt and https://github.com/F0bes/gs4ps2.